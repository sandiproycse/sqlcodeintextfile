SELECT * FROM employee;

SELECT * FROM employee ORDER BY salary;

-- To find the largest salary getting employee
SELECT * FROM employee ORDER BY salary DESC;

-- To find all the employee first order by sex and then name
SELECT * FROM employee ORDER BY sex,first_name, last_name;

-- To find the first 5 employee
SELECT * FROM employee LIMIT 5;

-- To find the first_name and last_name of all employee
SELECT first_name, last_name FROM employee;

--find the forename and surename of all employee
SELECT first_name AS forename, last_name AS surename FROM employee;

-- find out all the different genders
SELECT DISTINCT sex FROM employee;

SELECT DISTINCT branch_id FROM employee;

-- find the number of employees
SELECT COUNT(emp_id) FROM  employee;

SELECT COUNT(super_id) FROM employee;

-- find the number of female employees born after 1970
SELECT COUNT(emp_id) FROM employee WHERE sex = 'F' AND birth_day > '1970-01-01';

-- find the average of all employee salaries
SELECT AVG(salary) FROM employee;

SELECT AVG(salary) FROM employee WHERE sex = 'M';

-- find the sum of all employee's salaries
SELECT SUM(salary) FROM employee;

-- find out how many males and females there are
SELECT COUNT(sex) FROM employee;
SELECT COUNT(sex),sex FROM employee GROUP BY sex;

-- find the total sales of each salesman & total spend of each client
SELECT SUM(total_sales), emp_id FROM works_with GROUP BY emp_id;
SELECT SUM(total_sales), client_id FROM works_with GROUP BY client_id;

-- find any client's who are an LLC
SELECT * FROM client WHERE client_name LIKE '%LLC';

-- find any branck suppliers who are in the label business
SELECT * FROM branch_supplier WHERE supplier_name LIKE '%Label%';

-- find any employee born in october
SELECT * FROM employee WHERE birth_day LIKE '____-10-__';
SELECT * FROM employee WHERE birth_day LIKE '____-02%';

-- find any client who are schools
SELECT * FROM client WHERE client_name LIKE '%school%';

-- find a list of employee and branch names
SELECT first_name FROM employee;
SELECT branch_name FROM branch;

SELECT first_name AS Company_Names FROM employee UNION SELECT branch_name FROM branch
UNION SELECT client_name FROM client;

-- find a list of all client & branch suppliers names
SELECT client_name, client.branch_id FROM client
UNION 
SELECT supplier_name, branch_supplier.branch_id FROM branch_supplier;

-- find a list of all money spen or earned by the company
SELECT salary FROM employee UNION 
SELECT total_sales FROM works_with;

INSERT INTO branch VALUES(4,'Buffalo', NULL, NULL);
SELECT * FROM branch;

--find all branches and the names of their managers
SELECT employee.emp_id, employee.first_name, branch.branch_name
FROM employee JOIN branch 
ON employee.emp_id = branch.mgr_id;

SELECT employee.emp_id, employee.first_name, branch.branch_name
FROM employee LEFT JOIN branch 
ON employee.emp_id = branch.mgr_id;

SELECT employee.emp_id, employee.first_name, branch.branch_name
FROM employee RIGHT JOIN branch 
ON employee.emp_id = branch.mgr_id;

-- find names of all employees who have sold over 30,000 to a single client
SELECT works_with.emp_id
FROM works_with WHERE works_with.total_sales > 30000;

SELECT employee.first_name, employee.last_name
FROM employee
WHERE employee.emp_id IN(
    SELECT works_with.emp_id
    FROM works_with WHERE works_with.total_sales > 30000);

    -- find all clients who are handled by the branch 
    -- that Michael Scott manages
    -- Assume you know Michael's ID
    SELECT branch.branch_id
    FROM branch
    WHERE branch.mgr_id = 102;

SELECT client.client_name FROM client
WHERE client.branch_id = (
    SELECT branch.branch_id FROM branch WHERE branch.mgr_id = 102
);

SELECT client.client_name FROM client
WHERE client.branch_id = (
    SELECT branch.branch_id FROM branch WHERE branch.mgr_id = 102
    LIMIT 1
);


SELECT * FROM employee;
SELECT employee.emp_id FROM employee WHERE first_name = 'Michael' AND last_name = 'Scott';

SELECT client.client_name FROM client
WHERE client.branch_id = (
    SELECT branch.branch_id FROM branch WHERE branch.mgr_id = (SELECT employee.emp_id FROM employee WHERE first_name = 'Michael' AND last_name = 'Scott')
);

DELETE FROM employee WHERE emp_id = 102;
SELECT * FROM branch;
SELECT * FROM employee;

DELETE FROM branch WHERE branch_id = 2;
SELECT * FROM branch_supplier;